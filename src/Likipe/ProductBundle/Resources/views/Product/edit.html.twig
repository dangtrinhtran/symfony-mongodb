{% extends "LikipeBackendBundle::layout.html.twig" %}
{% block title "Edit product" %}
{% block content %}
<div class="container">
	<div class="row-fluid blog">
		<h1>Edit product!</h1>
		<form class="form-product form-horizontal" action="" method="POST" enctype="multipart/form-data">
			<div class="content">
			{{ form_errors(form) }}
				<div class="form-content clearfix row-fluid">
					<div class="form-info span4">
					{{ form_widget(form) }}
					</div>
					{{ form_rest(form) }}
				</div>
				<div class="input-upload">
					<input id="fileupload" type="file" name="filesUpload">
				</div>
				<ul class="images-response row-fluid" style="list-style: none">
					
				</ul>
				<input type="hidden" value="{{ iProductId }}" name="iProductId">
				<div class="form-action" style="padding-top: 50px;">
					<input class="btn btn-success" type="submit" value="{% trans %}Update{% endtrans %}" />
					<input class="btn btn-info" type="button" onclick="location.href='{{ path('LikipeProductBundle_Product_index') }}'" value="{% trans %}Cancel{% endtrans %}" />
				</div>
			</div>
		</form>
	</div>

</div> <!-- /container -->
{% endblock %}
{% block script %}
<script type="text/javascript">
	jQuery(document).ready(function($) {
		var iProductId = $("input[name='iProductId']").val();
		$.ajax({
			type: 'GET',
			url: Routing.generate('LikipeProductBundle_Product_getGallaryAjax', { iProductId: iProductId }),
			contentType: 'application/json',
			success: function(data) {
				$(".images-response").html(render(data));
			}
		});
	});
	
	function render(data){
		var sHtml = '';
			for(var i in data){
				sHtml += '<li class="image-item span2">';
				sHtml += '<div class="alert alert-danger"><span class="close remove-image">';
				sHtml += '&times;</span><strong>Remove</strong></div>';
				sHtml += '<img class="img-thumbnail" src="https://localhost/symfony-mongodb/web/' + data[i].url + '">';
				sHtml += '<input name="urlImage[' + data[i].filesize + ']" value="' + data[i].url + '" type="hidden" >';
				sHtml += '<input name="requestUrl" value="' + data[i].url + '" type="hidden" >';
				sHtml += '</li>';
			}
		return sHtml;
	}
	</script>
{% endblock %}